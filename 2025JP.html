<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
    <title>å®¢è£½åŒ–æ—…è¡Œè¡Œç¨‹</title>
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <style>
        /* åŸºç¤ Reset & è®Šæ•¸ - æº«æš–æ·ºç±³é»ƒè‰²ä¸»é¡Œ (Cream/Beige Theme) */
        :root {
            --cream-bg: #F8F6F0; 
            --surface-color: #FFFFFF; 
            --dark-text: #3D3D3D; 
            --secondary-text: #554949; 
            --primary-color: #8D6EFB; 
            --accent-color: #6C5CE7; 
            --soft-border: #D0CFCB; 
            --padding-base: 16px;
            --radius-base: 12px; 
            /* ç§»é™¤èˆŠå­—é«”è®Šæ•¸ï¼Œç›´æ¥åœ¨ body ä¸­å®šç¾© System Font Stack */
            --timeline-line-color: var(--soft-border);
            --soft-shadow: 0 4px 10px rgba(0, 0, 0, 0.05); 
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        body {
            /* æ‡‰ç”¨åœ“æ½¤ç¾ä»£é¢¨æ ¼çš„ System Font Stack */
            font-family: -apple-system, system-ui, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
            background-color: var(--cream-bg);
            color: var(--dark-text);
            line-height: 1.6;
            -webkit-font-smoothing: antialiased;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
        }

        /* App å®¹å™¨èˆ‡ Safe Area */
        #app {
            padding-top: calc(env(safe-area-inset-top) + var(--padding-base));
            padding-bottom: env(safe-area-inset-bottom);
            flex-grow: 1;
            display: flex;
            flex-direction: column;
        }

        /* é ‚éƒ¨æ¨™é¡Œèˆ‡æ—¥æœŸé¸æ“‡å™¨é‡æ§‹å€åŸŸ */
        header {
            padding: 0 0 var(--padding-base); 
        }
        
        /* æ¨™é¡Œå€ç½®ä¸­å°é½Š */
        .trip-header {
            text-align: center;
            padding: 0 var(--padding-base) 10px;
        }
        
        .trip-pre-title {
            font-size: 0.85rem;
            color: var(--secondary-text);
            margin-bottom: 2px;
        }

        .trip-main-title {
            font-size: 1.8rem;
            font-weight: 700; /* ä¿æŒç²—é«” */
            color: var(--dark-text);
        }

        /* å¹´ä»½/æœˆä»½è³‡è¨Š */
        .month-year {
            font-size: 0.8rem;
            color: var(--secondary-text);
            text-align: center;
            margin-bottom: var(--padding-base);
        }

        /* æ—¥æœŸé¸æ“‡å™¨å®¹å™¨ - å¯¦ç¾æ°´å¹³æ»‘å‹• */
        .date-selector-container {
            width: 100%;
            overflow-x: auto;
            white-space: nowrap; 
            padding: 0 var(--padding-base);
            /* éš±è—æ»¾å‹•æ¢ - App é«”é©—å„ªåŒ– */
            -ms-overflow-style: none; 
            scrollbar-width: none; 
        }

        .date-selector-container::-webkit-scrollbar {
            display: none; 
        }

        .date-selector {
            display: flex;
            gap: 10px;
            align-items: center;
            padding-bottom: 5px; 
        }

        /* æ—¥æœŸé …ç›®æ¨£å¼ */
        .date-item {
            display: inline-flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 5px 8px;
            cursor: pointer;
            transition: color 0.2s;
            min-width: 50px; 
        }
        
        .date-item .day-abbr {
            font-size: 0.8rem;
            font-weight: 500;
            color: var(--secondary-text);
            margin-bottom: 2px;
        }
        
        .date-item .day-num {
            font-size: 1.4rem;
            font-weight: 700; /* ä¿æŒç²—é«” */
            color: var(--dark-text);
        }

        /* é¸ä¸­ç‹€æ…‹æ¨£å¼ */
        .date-item.is-selected {
            background-color: var(--surface-color); 
            border-radius: var(--radius-base);
            box-shadow: var(--soft-shadow);
        }

        .date-item.is-selected .day-abbr,
        .date-item.is-selected .day-num {
            color: var(--primary-color); 
        }

        /* ä»Šæ—¥è¡Œç¨‹æ¦‚è¦½ */
        .today-summary {
            background-color: var(--surface-color);
            margin: var(--padding-base) var(--padding-base); 
            padding: var(--padding-base);
            border-radius: var(--radius-base);
            box-shadow: var(--soft-shadow);
            border: 1px solid var(--soft-border);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .city-info h3 {
            font-size: 1.3rem;
            margin-bottom: 4px;
            color: var(--dark-text);
        }

        .weather-info {
            text-align: right;
            font-size: 1rem;
            color: var(--secondary-text);
        }

        .weather-info .icon {
            font-size: 1.5rem;
            margin-bottom: 4px;
            color: #FFD700; 
        }

        /* è¡Œç¨‹æ¸…å–® (Timeline å€) */
        .trip-list-container {
            flex-grow: 1;
            overflow-y: auto;
            padding: 0 var(--padding-base) var(--padding-base);
        }

        .timeline {
            position: relative;
            padding-left: 30px; 
        }

        .timeline::before {
            content: '';
            position: absolute;
            top: 0;
            left: 10px;
            width: 2px;
            height: 100%;
            background-color: var(--timeline-line-color); 
        }

        .timeline-item {
            position: relative;
            padding-bottom: 25px;
            padding-left: 20px;
        }

        .timeline-item:last-child {
            padding-bottom: 0;
        }
        
        /* è®“è¡Œç¨‹é …ç›®å¯é»æ“Š */
        .item-content {
            cursor: pointer; 
            background-color: var(--surface-color);
            padding: 15px;
            border-radius: var(--radius-base);
            box-shadow: var(--soft-shadow);
            border: 1px solid var(--soft-border); 
            display: grid;
            grid-template-areas: "icon type time" "icon name name";
            grid-template-columns: 30px 1fr auto;
            gap: 5px 10px;
            align-items: center;
            transition: transform 0.1s, box-shadow 0.1s;
        }

        .item-content:active {
            transform: scale(0.99); 
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.05);
        }


        .timeline-dot {
            position: absolute;
            top: 0;
            left: -20px; 
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background-color: var(--primary-color);
            border: 3px solid var(--cream-bg); 
            z-index: 10;
        }

        .item-icon {
            grid-area: icon;
            font-size: 1.4rem;
            text-align: center;
        }
        
        /* èª¿æ•´ç‰¹å®šé¡å‹åœ–æ¨™é¡è‰² */
        .item-icon[data-type="FLIGHT"] { color: #3498DB; } 
        .item-icon[data-type="HOTEL"] { color: #2ECC71; } 
        .item-icon[data-type="CAR"] { color: #F39C12; } 
        .item-icon[data-type="FOOD"] { color: #E74C3C; } 
        .item-icon[data-type="ACTIVITY"] { color: #9B59B6; } 
        .item-icon[data-type="TRANSPORT"] { color: #3498DB; }

        .item-type {
            grid-area: type;
            font-size: 0.8rem;
            font-weight: 500;
            color: var(--secondary-text);
            text-transform: uppercase;
        }

        .item-time, .item-name {
            color: var(--dark-text); 
        }

        /* Modal å½ˆå‡ºè¦–çª—æ¨£å¼ */
        #modal-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            display: none; 
            background-color: rgba(0, 0, 0, 0.4); 
            z-index: 1000;
            flex-direction: column;
            justify-content: flex-end; 
            align-items: center;
        }
        
        #modal-container.is-visible {
            display: flex; 
        }
        
        .modal-content {
            background-color: var(--surface-color); 
            width: 100%;
            max-width: 600px; 
            border-top-left-radius: 20px;
            border-top-right-radius: 20px;
            padding: var(--padding-base);
            padding-bottom: calc(var(--padding-base) + env(safe-area-inset-bottom)); 
            max-height: 90vh; 
            overflow-y: auto;
            transform: translateY(100%); 
            transition: transform 0.3s ease-out; 
        }
        
        .modal-content.slide-in {
            transform: translateY(0); 
        }
        
        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: var(--padding-base);
            padding-bottom: 10px;
            border-bottom: 1px solid var(--soft-border); 
        }
        
        .modal-header h2 {
            font-size: 1.4rem;
            font-weight: 700;
            color: var(--dark-text);
        }
        
        .close-modal-btn {
            background: none;
            border: none;
            color: var(--secondary-text);
            font-size: 1.5rem;
            cursor: pointer;
            padding: 5px;
            line-height: 1;
        }
        
        .modal-body h3 {
            font-size: 1.1rem;
            color: var(--primary-color);
            margin-bottom: 8px;
        }
        
        .modal-notes {
            background-color: var(--cream-bg); 
            padding: 12px;
            border-radius: var(--radius-base);
            font-size: 0.95rem;
            color: var(--dark-text);
            white-space: pre-wrap; 
            border: 1px solid var(--soft-border);
        }
        
        /* å°èˆªæŒ‰éˆ•æ¨£å¼ */
        .map-btn {
            display: block;
            width: 100%;
            padding: 12px;
            margin-top: var(--padding-base);
            background-color: var(--primary-color); 
            color: white; 
            border: none;
            border-radius: var(--radius-base);
            font-size: 1.1rem;
            font-weight: 600;
            text-align: center;
            text-decoration: none; 
            transition: background-color 0.2s;
        }
        
        .map-btn:hover {
            background-color: var(--accent-color);
        }
        
        /* RWD èª¿æ•´ */
        @media (max-width: 480px) {
            .trip-title {
                font-size: 1.6rem;
            }
            .item-content {
                padding: 12px;
                gap: 5px;
            }
        }

    </style>
</head>
<body>
    <div id="app">
        <header>
            <div class="trip-header">
                <div class="trip-pre-title">Summer Trip</div>
                <div class="trip-main-title">åŒ—æµ·é“</div>
            </div>

            <!-- æœˆä»½/å¹´ä»½è³‡è¨Š -->
            <div class="month-year" id="month-year-display">AUG 2025</div>

            <!-- æ—¥æœŸé¸æ“‡å™¨å®¹å™¨ (æ°´å¹³æ»‘å‹•) -->
            <div class="date-selector-container">
                <div class="date-selector" id="date-selector-list">
                    <!-- æ—¥æœŸé …ç›®å°‡ç”± JS æ¸²æŸ“è‡³æ­¤ -->
                </div>
            </div>
        </header>

        <!-- ä»Šæ—¥è¡Œç¨‹æ¦‚è¦½ -->
        <div class="today-summary">
            <div class="city-info">
                <h3 id="current-city"></h3>
                <p>Day <span id="current-day-num"></span></p>
            </div>
            <div class="weather-info">
                <div class="icon" id="current-weather-icon"></div>
                <div id="current-weather"></div>
            </div>
        </div>

        <!-- è¡Œç¨‹æ¸…å–® (Timeline) -->
        <main class="trip-list-container">
            <div class="timeline" id="trip-timeline">
                <!-- è¡Œç¨‹é»å°‡ç”± JS æ¸²æŸ“è‡³æ­¤ -->
            </div>
        </main>
    </div>

    <!-- å½ˆå‡ºè¦–çª—å®¹å™¨ -->
    <div id="modal-container">
        <!-- Modal å…§å®¹å°‡ç”± JS æ¸²æŸ“è‡³æ­¤ -->
    </div>

    <script>
        // è¡Œç¨‹ç¯„ä¾‹è³‡æ–™ (JSON é™£åˆ—)
        // æ˜ŸæœŸç¸®å¯«åƒè€ƒ: 0=SUN, 1=MON, 2=TUE, 3=WED, 4=THU, 5=FRI, 6=SAT
        const tripData = [
            // DAY 1: æŠµé”æ—¥ (2025.08.09)
            {
                date: '2025-08-09', dayWeek: 6, dayNum: 1, city: 'æ–°åƒæ­²', weather: 'æœªçŸ¥', weatherIcon: 'âœˆï¸',
                activities: [
                    { id: 101, time: '12:45', type: 'FLIGHT', name: 'TR892 æ¡ƒåœ’å‡ºç™¼', icon: 'ğŸ›«', notes: 'ç™»æ©Ÿæ™‚é–“ 12:15ï¼Œè«‹é ç•™å……è£•æ™‚é–“ã€‚' },
                    { id: 102, time: '17:45', type: 'FLIGHT', name: 'æŠµé”æ–°åƒæ­²åœ‹éš›æ©Ÿå ´ (CTS)', icon: 'ğŸ›¬', notes: 'è«‹åœ¨åœ‹éš›ç·šèˆªå»ˆé™è½å¾Œï¼Œæº–å‚™å¥½å…¥å¢ƒè³‡æ–™ã€‚' },
                    { id: 103, time: '18:30', type: 'HOTEL', name: 'åŒ—æµ·é“å¸•æ‰˜å§†åœ‹éš›é£¯åº— Check-in', icon: 'ğŸ¨', notes: 'é£¯åº—ä½æ–¼åœ‹éš›ç·šæ—…å®¢èˆªå»ˆ 4~8Fã€‚' },
                    { id: 104, time: '19:30', type: 'FOOD', name: '(æ™š) æ©Ÿä¸Šæä¾›é¤é£Ÿ/æ©Ÿå ´ç°¡æ˜“æ™šé¤', icon: 'ğŸœ', notes: 'è‹¥æ©Ÿä¸Šé¤é£Ÿä¸å¤ ï¼Œå¯åœ¨æ©Ÿå ´ä¾¿åˆ©åº—è§£æ±ºã€‚' },
                ]
            },
            // DAY 2: æœ­å¹Œ (2025.08.10)
            {
                date: '2025-08-10', dayWeek: 0, dayNum: 2, city: 'æœ­å¹Œ', weather: 'æœªçŸ¥', weatherIcon: 'ğŸš—',
                activities: [
                    { id: 201, time: '07:30', type: 'FOOD', name: '(æ—©) é£¯åº—ç°¡æ˜“æ—©é¤', icon: 'ğŸ¥', notes: 'ç„¡' },
                    { id: 202, time: '09:30', type: 'CAR', name: 'Orix æ–°åƒæ­²æ©Ÿå ´åº— é ç´„ç§Ÿè»Š', icon: 'ğŸ”‘', notes: 'é ç´„æ™‚é–“ 09:30ï¼Œè«‹ç¢ºèªé§•ç…§å’Œåœ‹éš›é§•ç…§æº–å‚™é½Šå…¨ã€‚' },
                    { id: 203, time: '11:30', type: 'FOOD', name: 'å°æ¨½ä¸‰è§’å¸‚å ´ï¼šé±—å‹æœå¸‚æˆ–ä¸‰è§’æœå¸‚ (åˆé¤)', icon: 'ğŸ¦€', notes: 'ä¸‰è§’å¸‚å ´åœè»Šå ´æ¶ˆè²» Â¥2,000 å¯å…åœè»Šè²»ã€‚' },
                    { id: 204, time: '14:00', type: 'ACTIVITY', name: 'å°æ¨½å ºç”ºé€šå•†åº—è¡— (éŸ³æ¨‚ç›’å ‚/åŒ—ä¸€ç¡å­)', icon: 'ğŸ””', notes: 'é ç•™æ™‚é–“ç´„ 2-3 å°æ™‚ï¼Œå¯å“åš LeTAO ç”œé»ã€‚' },
                    { id: 205, time: '18:30', type: 'FOOD', name: 'å™å™è‹‘ æœ­å¹Œè–„é‡åº— é ç´„æ™šé¤', icon: 'ğŸ¥©', notes: 'å·²åœ¨å®˜ç¶²é ç´„ 18:30ï¼Œè«‹å‡ºç¤ºé ç´„ä¿¡ã€‚' },
                    { id: 206, time: '20:30', type: 'HOTEL', name: 'å”è‰é£¯åº—æœ­å¹Œ Check-in', icon: 'ğŸ›ï¸', notes: 'Check-in 15:00ï¼ŒCheck-out 12:00ã€‚' },
                ]
            },
            // DAY 3: æœ­å¹ŒéƒŠå€/è³¼ç‰© (2025.08.11)
            {
                date: '2025-08-11', dayWeek: 1, dayNum: 3, city: 'æœ­å¹Œ', weather: 'æœªçŸ¥', weatherIcon: 'ğŸ›ï¸',
                activities: [
                    { id: 301, time: '08:00', type: 'FOOD', name: '(æ—©) é£¯åº—ç°¡æ˜“æ—©é¤', icon: 'ğŸ¥', notes: 'å«æ—©é¤' },
                    { id: 302, time: '09:30', type: 'ACTIVITY', name: 'Costco æœ­å¹Œå€‰åº«åº—', icon: 'ğŸ›’', notes: 'ç‡Ÿæ¥­æ™‚é–“ 10:00-20:00ï¼Œè¨­æœ‰å¹³é¢åŠç«‹é«”åœè»Šå ´ã€‚' },
                    { id: 303, time: '12:30', type: 'FOOD', name: '(åˆ) ä¸‰äº•OUTLET è‡ªç†', icon: 'ğŸ”', notes: 'ç„¡' },
                    { id: 304, time: '14:30', type: 'ACTIVITY', name: 'åŒ—å»£å³¶ä¸‰äº•OUTLET PARK', icon: 'ğŸ‘—', notes: 'å¯ä¸‹è¼‰ç„¡é™è¬å“©éŠå„ªæƒ åˆ¸ã€‚' },
                    { id: 305, time: '17:30', type: 'ACTIVITY', name: 'ç‹¸å°è·¯å•†åº—è¡—', icon: 'ğŸ›ï¸', notes: 'å¯é€› BIC CAMERAã€PARCOã€LUSH ç­‰ï¼Œéœ€èµ°è·¯ã€‚' },
                    { id: 306, time: '19:30', type: 'FOOD', name: '(æ™š) ç‹¸å°è·¯è‡ªç†', icon: 'ğŸ¢', notes: 'å¯è€ƒæ…® Suage+ æ¹¯å’–å“©æˆ–æ•˜æ•˜è‹‘ç‡’è‚‰ã€‚' },
                ]
            },
            // DAY 4: ç™»åˆ¥ (2025.08.12)
            {
                date: '2025-08-12', dayWeek: 2, dayNum: 4, city: 'ç™»åˆ¥', weather: 'æœªçŸ¥', weatherIcon: 'â™¨ï¸',
                activities: [
                    { id: 401, time: '08:00', type: 'FOOD', name: '(æ—©) é£¯åº—ç°¡æ˜“æ—©é¤', icon: 'ğŸ¥', notes: 'å«æ—©é¤' },
                    { id: 402, time: '11:00', type: 'ACTIVITY', name: 'ES CON FIELD çƒå ´å°è¦½ (é ç´„æ™‚é–“)', icon: 'ğŸŸï¸', notes: 'è«‹æ–¼ Coca-Cola GATE å…§å ±åˆ°ï¼Œæ™‚é•·ç´„ 50 åˆ†é˜ã€‚' },
                    { id: 403, time: '12:30', type: 'FOOD', name: '(åˆ) ES CON FIELD è‡ªç†', icon: 'ğŸ•', notes: 'çƒå ´å…§æœ‰å¤šå…ƒç¾é£Ÿå€ã€‚' },
                    { id: 404, time: '15:30', type: 'ACTIVITY', name: 'å®¤è˜­å’–å•¡å»³ (ä¾‹å¦‚: THE LAMP ROOM CAFE)', icon: 'â˜•', notes: 'é–‹è»Šå‰å¾€ç™»åˆ¥é€”ä¸­å¯åœç•™å®¤è˜­ã€‚' },
                    { id: 405, time: '17:30', type: 'ACTIVITY', name: 'ç™»åˆ¥åœ°ç„è°·/æº«æ³‰è¡—', icon: 'ğŸŒ‹', notes: 'åœ°ç„è°·åœè»Šå ´æœ‰æ”¶è²»ã€‚' },
                    { id: 406, time: '19:00', type: 'HOTEL', name: 'ç¬¬ä¸€ç€§æœ¬é¤¨ Check-in & æº«æ³‰è¡— (æ™š)', icon: 'â™¨ï¸', notes: 'æ­¤é£¯åº—ä¸å«æ—©é¤ã€‚Check-in 14:00ã€‚' },
                ]
            },
            // DAY 5: å‡½é¤¨ (2025.08.13)
            {
                date: '2025-08-13', dayWeek: 3, dayNum: 5, city: 'å‡½é¤¨', weather: 'æœªçŸ¥', weatherIcon: 'â›°ï¸',
                activities: [
                    { id: 501, time: '08:00', type: 'FOOD', name: '(æ—©) é£¯åº—é™„è¿‘è‡ªç†', icon: 'ğŸ¥ª', notes: 'ç¬¬ä¸€ç€§æœ¬é¤¨ä¸å«æ—©é¤ã€‚' },
                    { id: 502, time: '10:30', type: 'TRANSPORT', name: 'è·¯éå…«é›²ãƒ»å¤§æ²¼åœ‹å®šå…¬åœ’', icon: 'ğŸï¸', notes: 'å…«é›²é“è·¯ä¼‘æ¯ç«™å¯è³¼è²·ä¹³è£½å“ã€‚' },
                    { id: 503, time: '12:30', type: 'FOOD', name: '(åˆ) å…«é›²é“è·¯ä¼‘æ¯ç«™', icon: 'ğŸ¥›', notes: 'å¯åœ¨æ­¤ä¼‘æ¯ä¸¦ç”¨é¤ã€‚' },
                    { id: 504, time: '16:00', type: 'HOTEL', name: 'å‡½é¤¨ç’°çƒæ™¯è§€é£¯åº— Check-in', icon: 'ğŸ›ï¸', notes: 'Check-in 15:00ï¼Œå«æ—©é¤ã€‚' },
                    { id: 505, time: '18:30', type: 'FOOD', name: 'ã¨ã‚“å¹³ å‡½é¤¨é§…å‰åº— (æ™š)', icon: 'ğŸ·', notes: 'å¯æ›¿æ›ç‚ºå…¶ä»–å‡½é¤¨å¸‚å€ç¾é£Ÿã€‚' },
                    { id: 506, time: '20:00', type: 'ACTIVITY', name: 'å‡½é¤¨å±±å¤œæ™¯', icon: 'âœ¨', notes: 'è‹¥çºœè»Šåœé§›å‰‡éœ€æ­ä¹˜å·´å£«ã€‚' },
                ]
            },
            // DAY 6: å‡½é¤¨å¸‚å€ (2025.08.14)
            {
                date: '2025-08-14', dayWeek: 4, dayNum: 6, city: 'å‡½é¤¨', weather: 'æœªçŸ¥', weatherIcon: 'ğŸ—¼',
                activities: [
                    { id: 601, time: '08:00', type: 'FOOD', name: '(æ—©) é£¯åº—ç°¡æ˜“è‡ªç†', icon: 'ğŸ¥', notes: 'å«æ—©é¤' },
                    { id: 602, time: '09:30', type: 'ACTIVITY', name: 'äº”ç¨œéƒ­å¡” & äº”ç¨œéƒ­å…¬åœ’', icon: 'ğŸ¯', notes: 'åœè»Šå ´åœ¨å¡”æ¨“æ—é‚Šã€‚äº”ç¨œéƒ­å¡”é–€ç¥¨ Â¥1,200/äºº (ç¶²è·¯æˆ–ä¾¿åˆ©åº—å¯èƒ½æœ‰æŠ˜æ‰£)ã€‚' },
                    { id: 603, time: '12:00', type: 'FOOD', name: 'å‡½é¤¨æœå¸‚/å°ä¸‘å¹¸é‹æ¼¢å ¡ (åˆé¤)', icon: 'ğŸ”', notes: 'æœå¸‚ 14:00 çµæŸç‡Ÿæ¥­ã€‚' },
                    { id: 604, time: '14:30', type: 'ACTIVITY', name: 'é‡‘æ£®ç´…ç£šå€‰åº«/å…«å¹¡å‚', icon: 'ğŸ˜ï¸', notes: 'ç´…ç£šå€‰åº«ç‡Ÿæ¥­æ™‚é–“ 09:30-19:00ã€‚' },
                    { id: 605, time: '19:00', type: 'FOOD', name: '(æ™š) å¸‚å€è‡ªç†', icon: 'ğŸ£', notes: 'ç„¡' },
                ]
            },
            // DAY 7: æ­¸åœ‹ (2025.08.15)
            {
                date: '2025-08-15', dayWeek: 5, dayNum: 7, city: 'å‡½é¤¨', weather: 'æœªçŸ¥', weatherIcon: 'ğŸ¡',
                activities: [
                    { id: 701, time: '08:00', type: 'FOOD', name: '(æ—©) é£¯åº—ç°¡æ˜“è‡ªç†', icon: 'ğŸ¥', notes: 'å«æ—©é¤' },
                    { id: 702, time: '09:30', type: 'CAR', name: 'Orix å‡½é¤¨æ©Ÿå ´åº— é ç´„é‚„è»Š', icon: 'ğŸ”‘', notes: 'éœ€é ç•™ 20 åˆ†é˜è»Šç¨‹è‡³æ©Ÿå ´ã€‚' },
                    { id: 703, time: '12:30', type: 'FLIGHT', name: 'IT237 å‡½é¤¨ HKD å‡ºç™¼', icon: 'ğŸ›«', notes: 'Boarding Time 12:00ã€‚' },
                    { id: 704, time: '15:45', type: 'FLIGHT', name: 'æŠµé”æ¡ƒåœ’ TPE', icon: 'ğŸ›¬', notes: 'ç„¡' },
                    { id: 705, time: '17:00', type: 'TRANSPORT', name: 'æ­é«˜éµè¿”å®¶', icon: 'ğŸš„', notes: 'ç„¡' },
                ]
            },
        ];

        // æ˜ŸæœŸç¸®å¯«åˆ—è¡¨ (è‹±æ–‡å¤§å¯«)
        const dayNames = ['SUN', 'MON', 'TUE', 'WED', 'THU', 'FRI', 'SAT'];

        // ç•¶å‰é¸ä¸­çš„è¡Œç¨‹æ—¥æœŸç´¢å¼•
        let currentTripIndex = 0;

        // DOM å…ƒç´ å¼•ç”¨
        const currentCityEl = document.getElementById('current-city');
        const currentDayNumEl = document.getElementById('current-day-num');
        const currentWeatherEl = document.getElementById('current-weather');
        const currentWeatherIconEl = document.getElementById('current-weather-icon');
        const tripTimelineEl = document.getElementById('trip-timeline');
        const modalContainerEl = document.getElementById('modal-container');
        const dateSelectorListEl = document.getElementById('date-selector-list');
        const monthYearDisplayEl = document.getElementById('month-year-display');


        /**
         * æ¸²æŸ“é ‚éƒ¨æ—¥æœŸé¸æ“‡å™¨
         */
        function renderDateSelector() {
            dateSelectorListEl.innerHTML = ''; // æ¸…ç©ºèˆŠå…§å®¹
            const firstDate = tripData[0].date;
            const fullDate = new Date(firstDate); 
            const month = fullDate.toLocaleString('en-US', { month: 'short' }).toUpperCase();
            const year = fullDate.getFullYear();
            
            // æ¸²æŸ“æœˆä»½/å¹´ä»½è³‡è¨Š (åªéœ€æ¸²æŸ“ä¸€æ¬¡)
            monthYearDisplayEl.textContent = `${month} ${year}`;
            
            tripData.forEach((day, index) => {
                // ç‚ºäº†å…¼å®¹æ€§ï¼Œä½¿ç”¨ 'YYYY-MM-DD' æ ¼å¼
                const dateParts = day.date.split('-'); 
                const dateObj = new Date(dateParts[0], dateParts[1] - 1, dateParts[2]);
                
                const dayAbbr = dayNames[dateObj.getDay()];
                const dayNum = dateObj.getDate();

                const dateItem = document.createElement('div');
                dateItem.className = 'date-item';
                dateItem.setAttribute('data-index', index);
                
                dateItem.addEventListener('click', () => selectDate(index));

                dateItem.innerHTML = `
                    <div class="day-abbr">${dayAbbr}</div>
                    <div class="day-num">${dayNum}</div>
                `;
                
                dateSelectorListEl.appendChild(dateItem);
            });
            
            // åˆå§‹åŒ–é¸ä¸­ Day 1
            selectDate(currentTripIndex, false); 
        }
        
        /**
         * é¸æ“‡æ—¥æœŸï¼Œä¸¦å°‡å…¶ç½®ä¸­
         */
        function selectDate(index, smooth = true) {
            currentTripIndex = index;
            
            // 1. æ›´æ–°é¸ä¸­æ¨£å¼
            document.querySelectorAll('.date-item').forEach((item, i) => {
                item.classList.toggle('is-selected', i === index);
            });
            
            // 2. æ¸²æŸ“è¡Œç¨‹ç´°ç¯€
            renderTripDetails(index);
            
            // 3. å°‡é¸ä¸­çš„æ—¥æœŸé …ç›®ç½®ä¸­ (App ç´šåˆ¥é«”é©—)
            const selectedItem = document.querySelector(`.date-item[data-index="${index}"]`);
            const container = document.querySelector('.date-selector-container');
            
            if (selectedItem && container) {
                // è¨ˆç®—æ»¾å‹•ä½ç½®
                const itemWidth = selectedItem.offsetWidth;
                const itemOffset = selectedItem.offsetLeft;
                const containerWidth = container.offsetWidth;
                
                // ç½®ä¸­è¨ˆç®—ï¼šé …ç›®å·¦é‚Šè· - (å®¹å™¨å¯¬åº¦ / 2) + (é …ç›®å¯¬åº¦ / 2)
                const scrollPos = itemOffset - (containerWidth / 2) + (itemWidth / 2);

                container.scrollTo({
                    left: scrollPos,
                    behavior: smooth ? 'smooth' : 'auto'
                });
            }
        }


        /**
         * æ¸²æŸ“è¡Œç¨‹ç´°ç¯€
         */
        function renderTripDetails(index) {
            const currentDay = tripData[index];
            if (!currentDay) return;

            // 1. æ›´æ–°é ‚éƒ¨æ¦‚è¦½è³‡è¨Š
            currentCityEl.textContent = currentDay.city;
            currentDayNumEl.textContent = currentDay.dayNum;
            currentWeatherEl.textContent = currentDay.weather;
            currentWeatherIconEl.textContent = currentDay.weatherIcon || 'â˜€ï¸';

            // 2. æ¸…ç©ºä¸¦æ¸²æŸ“è¡Œç¨‹é»
            tripTimelineEl.innerHTML = '';
            currentDay.activities.forEach(activity => {
                const activityJson = encodeURIComponent(JSON.stringify(activity));
                
                const itemHtml = `
                    <div class="timeline-item">
                        <div class="timeline-dot"></div>
                        <div class="item-content" data-activity='${activityJson}'>
                            <div class="item-icon" data-type="${activity.type}">${activity.icon}</div>
                            <div class="item-type">${activity.type.replace('TRANSPORT', 'ç§»å‹•/äº¤é€š')}</div>
                            <div class="item-time">${activity.time}</div>
                            <div class="item-name">${activity.name}</div>
                        </div>
                    </div>
                `;
                tripTimelineEl.insertAdjacentHTML('beforeend', itemHtml);
            });
            
            // 3. æ·»åŠ é»æ“Šäº‹ä»¶ç›£è½å™¨ (Modal)
            attachActivityListeners();
        }

        /**
         * ç‚ºæ¯å€‹è¡Œç¨‹é …ç›®æ·»åŠ é»æ“Šç›£è½å™¨
         */
        function attachActivityListeners() {
            document.querySelectorAll('.item-content').forEach(oldItem => {
                oldItem.removeEventListener('click', handleActivityClick);
            });

            document.querySelectorAll('.item-content').forEach(item => {
                item.addEventListener('click', handleActivityClick);
            });
        }
        
        // é»æ“Šè™•ç†å‡½æ•¸
        function handleActivityClick(event) {
            const activityJson = event.currentTarget.getAttribute('data-activity');
            const activity = JSON.parse(decodeURIComponent(activityJson)); 
            showModal(activity);
        }


        /**
         * é¡¯ç¤º Modal å½ˆå‡ºè¦–çª—
         */
        function showModal(activity) {
            // ä¿®å¾©å¾Œçš„ Google Maps URL
            const mapUrl = `https://www.google.com/maps/search/?api=1&query=${encodeURIComponent(activity.name)}`;

            const modalContent = `
                <div class="modal-content">
                    <div class="modal-header">
                        <h2>${activity.icon} ${activity.name}</h2>
                        <button class="close-modal-btn" onclick="closeModal()">Ã—</button>
                    </div>
                    <div class="modal-body">
                        <h3>å‚™è¨» / è©³ç´°è³‡è¨Š</h3>
                        <pre class="modal-notes">${activity.notes || 'ç„¡é¡å¤–å‚™è¨»ã€‚'}</pre>
                        
                        <a href="${mapUrl}" target="_blank" class="map-btn">
                            Google Maps å°èˆª
                        </a>
                    </div>
                </div>
            `;
            
            modalContainerEl.innerHTML = modalContent;
            modalContainerEl.classList.add('is-visible');
            
            setTimeout(() => {
                modalContainerEl.querySelector('.modal-content').classList.add('slide-in');
            }, 10);
        }
        
        /**
         * é—œé–‰ Modal å½ˆå‡ºè¦–çª—
         */
        function closeModal() {
            const contentEl = modalContainerEl.querySelector('.modal-content');
            
            if (contentEl) {
                contentEl.classList.remove('slide-in');
            }
            
            setTimeout(() => {
                modalContainerEl.classList.remove('is-visible');
                modalContainerEl.innerHTML = ''; 
            }, 300);
        }

        // å°‡ closeModal å‡½æ•¸æš´éœ²çµ¦å…¨åŸŸç’°å¢ƒ
        window.closeModal = closeModal;


        // æ‡‰ç”¨ç¨‹å¼å•Ÿå‹•ï¼šæ¸²æŸ“æ—¥æœŸé¸æ“‡å™¨å’Œ Day 1
        document.addEventListener('DOMContentLoaded', () => {
            renderDateSelector();
        });
    </script>
</body>
</html>
